class CartRemoveButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault(),this.closest("cart-items").updateQuantity(this.dataset.index,0)})}}customElements.define("cart-remove-button",CartRemoveButton);class CartItems extends HTMLElement{constructor(){super(),this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status"),this.cartErrors=document.getElementById("cart-errors"),this.currentItemCount=Array.from(this.querySelectorAll('[name="updates[]"]')).reduce((e,t)=>e+parseInt(t.value),0),this.debouncedOnChange=debounce(e=>{this.onChange(e)},300),this.addEventListener("change",this.debouncedOnChange.bind(this)),window.postMessage({type:"checkSamples",data:{itemCount:this.currentItemCount}},"*")}onChange(e){null!==e.target&&this.updateQuantity(e.target.dataset.index,e.target.value,document.activeElement.getAttribute("name"))}getSectionsToRender(){var e=[{id:"main-cart-items",section:document.getElementById("main-cart-items")?.dataset.id,selector:".js-contents"},{id:"mini-cart",section:"mini-cart",selector:".shopify-section"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"main-cart-footer",section:document.getElementById("main-cart-footer")?.dataset.id,selector:".js-contents"}];return document.querySelector("#main-cart-footer .free-shipping")&&e.push({id:"main-cart-footer",section:document.getElementById("main-cart-footer")?.dataset.id,selector:".free-shipping"}),e}updateQuantity(t,e,s){this.enableLoading(t);var i=this.getSectionsToRender().map(e=>e.section),e=JSON.stringify({line:t,quantity:e,sections:i,sections_url:window.location.pathname});fetch(""+routes.cart_change_url,{...fetchConfig(),body:e}).then(e=>e.text()).then(e=>{const i=JSON.parse(e);this.classList.toggle("is-empty",0===i.item_count);e=document.getElementById("main-cart-footer"),e&&e.classList.toggle("is-empty",0===i.item_count),this.getSectionsToRender().forEach(e=>{var t=document.getElementById(e.id);t&&(t=t.querySelector(e.selector)||t)&&i.sections[e.section]&&(t.innerHTML=this.getSectionInnerHTML(i.sections[e.section],e.selector))}),this.updateLiveRegions(t,i.item_count),e=document.getElementById("CartItem-"+t);e&&s&&e.querySelector(`[name="${s}"]`).focus(),this.disableLoading()}).catch(()=>{this.querySelectorAll(".loading-overlay").forEach(e=>e.classList.add("hidden")),this.disableLoading(),this.cartErrors&&(this.cartErrors.textContent=cartStrings.error)})}updateLiveRegions(e,t){var i;this.currentItemCount===t&&(i=document.getElementById("Line-item-error-"+e))&&(i.querySelector(".cart-item__error-text").innerHTML=cartStrings.quantityError.replace("[quantity]",document.getElementById("Quantity-"+e).value)),this.currentItemCount=t,this.lineItemStatusElement&&this.lineItemStatusElement.setAttribute("aria-hidden",!0);const s=document.getElementById("cart-live-region-text");s&&(s.setAttribute("aria-hidden",!1),setTimeout(()=>{s.setAttribute("aria-hidden",!0)},1e3))}getSectionInnerHTML(e,t){return(new DOMParser).parseFromString(e,"text/html").querySelector(t)?.innerHTML}enableLoading(e){var t=document.getElementById("main-cart-items"),t=(t&&t.classList.add("cart__items--disabled"),this.querySelectorAll(".loading-overlay")[e-1]);t&&t.classList.remove("hidden"),document.activeElement.blur(),this.lineItemStatusElement&&this.lineItemStatusElement.setAttribute("aria-hidden",!1)}disableLoading(){var e=document.getElementById("main-cart-items");e&&e.classList.remove("cart__items--disabled")}renderContents(i){this.getSectionsToRender().forEach(e=>{var t=document.getElementById(e.id);console.log(t,i.sections[e.id]),t&&(t.innerHTML=this.getSectionInnerHTML(i.sections[e.id],e.selector))})}}customElements.define("cart-items",CartItems);class CartNote extends HTMLElement{constructor(){super(),this.addEventListener("change",debounce(e=>{e=JSON.stringify({note:e.target.value});fetch(""+routes.cart_update_url,{...fetchConfig(),body:e})},300))}}customElements.define("cart-note",CartNote);class DiscountCode extends HTMLElement{constructor(){super(),isStorageSupported("session")&&(this.setupDiscount(),this.addEventListener("change",e=>{window.sessionStorage.setItem("discount",e.target.value)}))}setupDiscount(){var e=window.sessionStorage.getItem("discount");null!==e&&(this.querySelector('input[name="discount"]').value=e)}}customElements.define("discount-code",DiscountCode);class ShippingCalculator extends HTMLElement{constructor(){super(),this.setupCountries(),this.errors=this.querySelector("#ShippingCalculatorErrors"),this.success=this.querySelector("#ShippingCalculatorSuccess"),this.zip=this.querySelector("#ShippingCalculatorZip"),this.country=this.querySelector("#ShippingCalculatorCountry"),this.province=this.querySelector("#ShippingCalculatorProvince"),this.button=this.querySelector("button"),this.button.addEventListener("click",this.onSubmitHandler.bind(this))}setupCountries(){Shopify&&Shopify.CountryProvinceSelector&&new Shopify.CountryProvinceSelector("ShippingCalculatorCountry","ShippingCalculatorProvince",{hideElement:"ShippingCalculatorProvinceContainer"})}onSubmitHandler(e){e.preventDefault(),this.errors.classList.add("hidden"),this.success.classList.add("hidden"),this.zip.classList.remove("invalid"),this.country.classList.remove("invalid"),this.province.classList.remove("invalid"),this.button.classList.add("loading"),this.button.setAttribute("disabled",!0);e=JSON.stringify({shipping_address:{zip:this.zip.value,country:this.country.value,province:this.province.value}});let t=routes.cart_url+"/shipping_rates.json";t=t.replace("//","/"),fetch(t,{...fetchConfig("javascript"),body:e}).then(e=>e.json()).then(e=>{if(e.shipping_rates)this.success.classList.remove("hidden"),this.success.innerHTML="",e.shipping_rates.forEach(e=>{var t=document.createElement("p");t.innerHTML=`${e.name}: ${e.price} `+Shopify.currency.active,this.success.appendChild(t)});else{let i=[];Object.entries(e).forEach(([e,t])=>{i.push(e.charAt(0).toUpperCase()+e.slice(1)+" "+t[0])}),this.errors.classList.remove("hidden"),this.errors.querySelector(".errors").innerHTML=i.join("; ")}}).catch(e=>{console.error(e)}).finally(()=>{this.button.classList.remove("loading"),this.button.removeAttribute("disabled")})}}customElements.define("shipping-calculator",ShippingCalculator);